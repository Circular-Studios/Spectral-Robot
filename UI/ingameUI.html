<html>
	<head>
		<title>In-game UI</title>

		<link rel="stylesheet" type="text/css" href="normalize.css" />
		<link rel="stylesheet" type="text/css" href="ingame_style.css">

		<script src="jquery-2.1.0.min.js"></script>
		<script src="jquery-ui-1.10.4.custom.min.js"></script>

		
	</head>
	<body>
	
	<div style="color:white;position:absolute;right:10px;top:10px">Alpha 0.11</div>

	<!-- Turn counter -->
	<div class="topContainer">
		<div class="turnCounter">
			<p>Turn: <span id="turnCount">1</span>/10</p>
			<p><span id="team">Robots'</span> turn</p>
		</div>
	</div>

	<!-- Character container -->
	<div class="characters">
		<div class="players">
			<div class="playerCharacter">
				<div class="charName">Robots</div>
			</div>
			<div class="playerCharacter" onclick="selectCharacter( 0 )">
				<div class="charName"><h3>BroBot</h3></div>
				<div class="abilityCounter"><span>Actions left: <span id="actions0">3</span></span></div>
				<div class="healthContainer">
					<div class="healthbar" style="width:100%" id="char0"></div>
					<div class="health"><span><span id="hp0">35</span>/35</span></div>
				</div>
			</div>
			<div class="playerCharacter" onclick="selectCharacter( 1 )">
				<div class="charName"><h3>Bro-erBot</h3></div>
				<div class="abilityCounter"><span>Actions left: <span id="actions1">3</span></span></div>
				<div class="healthContainer">
					<div class="healthbar" style="width:100%" id="char1"></div>
					<div class="health"><span><span id="hp1">35</span>/35</span></div>
				</div>
			</div>
			<div class="playerCharacter" onclick="selectCharacter( 2 )">
				<div class="charName"><h3>Bro-estBot</h3></div>
				<div class="abilityCounter"><span>Actions left: <span id="actions2">3</span></span></div>
				<div class="healthContainer">
					<div class="healthbar" style="width:100%" id="char2"></div>
					<div class="health"><span><span id="hp2">35</span>/35</span></div>
				</div>
			</div>
			<div class="playerCharacter" onclick="selectCharacter( 3 )">
				<div class="charName"><h3>BrosephBot</h3></div>
				<div class="abilityCounter"><span>Actions left: <span id="actions3">3</span></span></div>
				<div class="healthContainer">
					<div class="healthbar" style="width:100%" id="char3"></div>
					<div class="health"><span><span id="hp3">35</span>/35</span></div>
				</div>
			</div>
		</div>
		<div class="enemies">
			<div class="enemyCharacter">
				<div class="charName">Werewolves</div>
			</div>
			<div class="enemyCharacter" onclick="selectCharacter( 4 )">
				<div class="charName"><h3>Papa Wolf</h3></div>
				<div class="abilityCounter"><span>Actions left: <span id="actions4">3</span></span></div>
				<div class="healthContainer">
					<div class="healthbar" style="width:100%" id="char4"></div>
					<div class="health"><span><span id="hp4">35</span>/35</span></div>
				</div>

			</div>
			<div class="enemyCharacter" onclick="selectCharacter( 5 )">
				<div class="charName"><h3>Big Bad Wolf</h3></div>
				<div class="abilityCounter"><span>Actions left: <span id="actions5">3</span></span></div>
				<div class="healthContainer">
					<div class="healthbar" style="width:100%" id="char5"></div>
					<div class="health"><span><span id="hp5">35</span>/35</span></div>
				</div>
			</div>
			<div class="enemyCharacter" onclick="selectCharacter( 6 )">
				<div class="charName"><h3>Another Wolf</h3></div>
				<div class="abilityCounter"><span>Actions left: <span id="actions6">3</span></span></div>
				<div class="healthContainer">
					<div class="healthbar" style="width:100%" id="char6"></div>
					<div class="health"><span><span id="hp6">35</span>/35</span></div>
				</div>

			</div>
			<div class="enemyCharacter" onclick="selectCharacter( 7 )">
				<div class="charName"><h3>Bob "I can't think of names" Wolf</h3></div>
				<div class="abilityCounter"><span>Actions left: <span id="actions7">3</span></span></div>
				<div class="healthContainer">
					<div class="healthbar" style="width:100%" id="char7"></div>
					<div class="health"><span><span id="hp7">35</span>/35</span></div>
				</div>
			</div>
		</div>
		
	</div>

	<!-- Abilities at the bottom of the screen -->

	<!-- Unit -->
	<div class="fullWidthContainer">
		<div class="abilities firestarter" id="abilities">
			<div class="abilityBox basicRanged" onclick="selectAbility(0)">
				<div class="tooltipBox basicRanged">
					<h4 class="abilityName">Basic Ranged Attack</h4>
					<p class="abilityDescription">Range: 3 spaces<br>
												  DMG: 7</p>

				</div>
			</div>
			<div class="abilityBox basicMelee" onclick="selectAbility(1)">
				<div class="tooltipBox basicMelee">
					<h4 class="abilityName">Basic Melee Attack</h4>
					<p class="abilityDescription">Range: 1 space<br>
												  DMG: 10</p>
				</div>
			</div>
		</div>
	</div>

	<script type="text/javascript">
		var selectedChar = 0;

		function setHp( hp, charNum ) {
			var percentHp = (hp / 35) * 100;
			var character = "char" + charNum;
			var health = "hp" + charNum;
			var currentHp = document.getElementById( health ).innerHTML;

			if( currentHp > hp )
			{
				takeDamage( hp, currentHp, charNum );
			}
			else 
			{
				document.getElementById( character ).style.width = percentHp + "%";
				document.getElementById( health ).innerHTML = ''+hp;
				var red = (1 - (hp / 35) ) * 255;
				var green = (hp / 35 ) * 255;
				document.getElementById( character ).style.backgroundColor = "rgb(" + red + ", " + green + ",0)"
			}
			//console.log(document.getElementById( health ).innerHTML)
		}

		function takeDamage( hp, currentHp, charNum )
		{
			var difference = currentHp - hp;
			var character = "char" + charNum;
			var percentHp = (currentHp / 35) * 100;
			var health = "hp" + charNum;
			var delay = 0;
			for( i = 0; i < difference; i++ ) 
			{
				delay += 50;
				//console.log( "currentHp: " + currentHp)
				setTimeout( function() {
					reduceHealth( charNum );
				}, delay );
			}
		}

		function reduceHealth(  charNum )
		{
			var character = "char" + charNum;
			var health = "hp" + charNum;
			
			var currentHp = document.getElementById( health ).innerHTML;
			currentHp--;
			
			var percentHp = (currentHp / 35) * 100;

			var red = (1 - (currentHp / 35) ) * 255;
			var green = (currentHp / 35 ) * 255;

			document.getElementById( character ).style.width = percentHp + "%";
			document.getElementById( health ).innerHTML = ''+currentHp;
			document.getElementById( character ).style.backgroundColor = "rgb(" + red + ", " + green + ",0)"
		}

		function selectCharacter( i ) { 
			console.log("selectCharacter called with value " + i)
			selectedChar = i;
			if( selectedChar == -1 )
			{
				document.getElementById( "abilities" ).style.display = "none";
			} else {
				document.getElementById( "abilities" ).style.display = "table";
			}
		}

		function selectAbility( i ) {
			console.log("ability " + i )
			dash.callFunction( "selectAbility", i );
		}

		function setTurn ( turnCount, team )
		{
			document.getElementById( "turnCount" ).innerHTML = '' + turnCount;
			if( team = 0 ) document.getElementById( "team" ).innerHTML = "Robots'";
			else document.getElementById( "team" ).innerHTML = "Werewolves'"
		}

		function setActionCount( count, unit )
		{
			document.getElementById( "actions" + unit ).innerHTML = '' + count;
		}

		</script>
	</body>
</html>
